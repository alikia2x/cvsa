---
import Layout from "@layouts/Layout.astro";

// 路由参数
const { aid } = Astro.params;
const videoAid = Number(aid);

// 数据库查询函数
async function getVideoMetadata(aid: number) {
    // TODO: 实现bilibili_metadata表查询
    return {};
}

async function getVideoSnapshots(aid: number) {
    // TODO: 实现video_snapshot表查询，按created_at排序，限制100条
    return [];
}

// 获取数据
const videoInfo = await getVideoMetadata(videoAid);
const snapshots = await getVideoSnapshots(videoAid);
---

<Layout>
    <div class="max-w-4xl mx-auto bg-white rounded-lg shadow p-6">
        <h1 class="text-2xl font-bold mb-4">视频信息: {videoAid}</h1>

        <!-- 视频基本信息 -->
        <div class="mb-6 p-4 border rounded-lg">
            <h2 class="text-xl font-semibold mb-2">基本信息</h2>
            <pre class="bg-gray-50 p-2 rounded">{JSON.stringify(videoInfo, null, 2)}</pre>
        </div>

        <!-- 视频快照数据 -->
        <div class="p-4 border rounded-lg">
            <h2 class="text-xl font-semibold mb-2">历史数据 (最新100条)</h2>
            <pre class="bg-gray-50 p-2 rounded">{JSON.stringify(snapshots, null, 2)}</pre>
        </div>
    </div>
</Layout>
